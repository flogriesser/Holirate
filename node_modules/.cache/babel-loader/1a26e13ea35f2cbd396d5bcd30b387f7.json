{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _objectWithoutProperties2 = require('babel-runtime/helpers/objectWithoutProperties');\n\nvar _objectWithoutProperties3 = _interopRequireDefault(_objectWithoutProperties2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require('react-dom');\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _libs = require('../../libs');\n\nvar _internal = require('../../libs/internal');\n\nvar _input = require('../input');\n\nvar _input2 = _interopRequireDefault(_input);\n\nvar _constants = require('./constants');\n\nvar _utils = require('../../libs/utils');\n\nvar _MountBody = require('./MountBody');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\n(function () {\n  var enterModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).enterModule;\n  enterModule && enterModule(module);\n})();\n\nvar idGen = new _utils.IDGenerator();\n\nvar haveTriggerType = function haveTriggerType(type) {\n  return _constants.HAVE_TRIGGER_TYPES.indexOf(type) !== -1;\n};\n\nvar isValidValue = function isValidValue(value) {\n  if (value instanceof Date) return true;\n  if (Array.isArray(value) && value.length !== 0 && value[0] instanceof Date) return true;\n  return false;\n}; // only considers date-picker's value: Date or [Date, Date]\n\n\nvar valueEquals = function valueEquals(a, b) {\n  var aIsArray = Array.isArray(a);\n  var bIsArray = Array.isArray(b);\n\n  var isEqual = function isEqual(a, b) {\n    // equal if a, b date is equal or both is null or undefined\n    var equal = false;\n    if (a && b) equal = a.getTime() === b.getTime();else equal = a === b && a == null;\n    return equal;\n  };\n\n  if (aIsArray && bIsArray) {\n    return isEqual(a[0], b[0]) && isEqual(a[1], b[1]);\n  }\n\n  if (!aIsArray && !bIsArray) {\n    return isEqual(a, b);\n  }\n\n  return false;\n};\n\nvar BasePicker = function (_Component) {\n  (0, _inherits3.default)(BasePicker, _Component);\n  (0, _createClass3.default)(BasePicker, null, [{\n    key: 'propTypes',\n    get: function get() {\n      return {\n        align: _libs.PropTypes.oneOf(['left', 'center', 'right']),\n        className: _libs.PropTypes.string,\n        format: _libs.PropTypes.string,\n        isShowTrigger: _libs.PropTypes.bool,\n        isReadOnly: _libs.PropTypes.bool,\n        isDisabled: _libs.PropTypes.bool,\n        placeholder: _libs.PropTypes.string,\n        onFocus: _libs.PropTypes.func,\n        onBlur: _libs.PropTypes.func,\n        // (Date|Date[]|null)=>(), null when click on clear icon\n        onChange: _libs.PropTypes.func,\n        // time select pannel:\n        value: _libs.PropTypes.oneOfType([_libs.PropTypes.instanceOf(Date), _libs.PropTypes.arrayOf(_libs.PropTypes.instanceOf(Date))])\n      };\n    }\n  }, {\n    key: 'defaultProps',\n    get: function get() {\n      return {\n        value: new Date(),\n        // (thisReactElement)=>Unit\n        onFocus: function onFocus() {},\n        onBlur: function onBlur() {}\n      };\n    }\n  }]);\n\n  function BasePicker(props, _type) {\n    var state = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    (0, _classCallCheck3.default)(this, BasePicker);\n    (0, _utils.require_condition)(typeof _type === 'string');\n\n    var _this = (0, _possibleConstructorReturn3.default)(this, (BasePicker.__proto__ || Object.getPrototypeOf(BasePicker)).call(this, props));\n\n    _this.type = _type; // type need to be set first\n\n    _this.state = Object.assign({}, state, {\n      pickerVisible: false\n    }, _this.propsToState(props));\n    _this.clickOutsideId = 'clickOutsideId_' + idGen.next();\n    return _this;\n  } // ---: start, abstract methods\n  // (state, props)=>ReactElement\n\n\n  (0, _createClass3.default)(BasePicker, [{\n    key: 'pickerPanel',\n    value: function pickerPanel(state, props) {\n      throw new _utils.Errors.MethodImplementationRequiredError(props);\n    }\n  }, {\n    key: 'getFormatSeparator',\n    value: function getFormatSeparator() {\n      return undefined;\n    } // ---: end, abstract methods\n\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      this.setState(this.propsToState(nextProps));\n    }\n    /**\n     * onPicked should only be called from picker pannel instance\n     * and should never return a null date instance\n     *\n     * @param value: Date|Date[]|null\n     * @param isKeepPannel: boolean = false\n     */\n\n  }, {\n    key: 'onPicked',\n    value: function onPicked(value) {\n      var isKeepPannel = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false; //only change input value on picked triggered\n\n      var hasChanged = !valueEquals(this.state.value, value);\n      this.setState({\n        pickerVisible: isKeepPannel,\n        value: value,\n        text: this.dateToStr(value)\n      });\n\n      if (hasChanged) {\n        this.props.onChange(value);\n        this.context.form && this.context.form.onFieldChange();\n      }\n    }\n  }, {\n    key: 'dateToStr',\n    value: function dateToStr(date) {\n      if (!isValidValue(date)) return '';\n      var tdate = date;\n      var formatter = (_constants.TYPE_VALUE_RESOLVER_MAP[this.type] || _constants.TYPE_VALUE_RESOLVER_MAP['default']).formatter;\n      var result = formatter(tdate, this.getFormat(), this.getFormatSeparator());\n      return result;\n    } // (string) => Date | null\n\n  }, {\n    key: 'parseDate',\n    value: function parseDate(dateStr) {\n      if (!dateStr) return null;\n      var type = this.type;\n      var parser = (_constants.TYPE_VALUE_RESOLVER_MAP[type] || _constants.TYPE_VALUE_RESOLVER_MAP['default']).parser;\n      return parser(dateStr, this.getFormat(), this.getFormatSeparator());\n    }\n  }, {\n    key: 'getFormat',\n    value: function getFormat() {\n      return this.props.format || _constants.DEFAULT_FORMATS[this.type];\n    }\n  }, {\n    key: 'propsToState',\n    value: function propsToState(props) {\n      var state = {};\n\n      if (this.isDateValid(props.value)) {\n        state.text = this.dateToStr(props.value);\n        state.value = props.value;\n      } else {\n        state.text = '';\n        state.value = null;\n      } // if (state.value == null) {\n      //   state.value = new Date()\n      // }\n\n\n      return state;\n    }\n  }, {\n    key: 'triggerClass',\n    value: function triggerClass() {\n      return this.type.includes('time') ? 'el-icon-time' : 'el-icon-date';\n    }\n  }, {\n    key: 'calcIsShowTrigger',\n    value: function calcIsShowTrigger() {\n      if (this.props.isShowTrigger != null) {\n        return !!this.props.isShowTrigger;\n      } else {\n        return haveTriggerType(this.type);\n      }\n    }\n  }, {\n    key: 'handleFocus',\n    value: function handleFocus() {\n      var _this2 = this;\n\n      this.isInputFocus = true;\n\n      if (haveTriggerType(this.type) && !this.state.pickerVisible) {\n        this.setState({\n          pickerVisible: true\n        }, function () {\n          _this2.props.onFocus(_this2);\n        });\n      }\n    }\n  }, {\n    key: 'handleBlur',\n    value: function handleBlur() {\n      this.isInputFocus = false;\n      this.props.onBlur(this);\n    }\n  }, {\n    key: 'handleKeydown',\n    value: function handleKeydown(evt) {\n      var keyCode = evt.keyCode; // tab\n\n      if (keyCode === 9 || keyCode === 27) {\n        this.setState({\n          pickerVisible: false\n        });\n        evt.stopPropagation();\n      }\n    }\n  }, {\n    key: 'togglePickerVisible',\n    value: function togglePickerVisible() {\n      this.setState({\n        pickerVisible: !this.state.pickerVisible\n      });\n    }\n  }, {\n    key: 'isDateValid',\n    value: function isDateValid(date) {\n      return date == null || isValidValue(date);\n    } // return true on condition\n    //  * input is parsable to date\n    //  * also meet your other condition\n\n  }, {\n    key: 'isInputValid',\n    value: function isInputValid(value) {\n      var parseable = this.parseDate(value);\n\n      if (!parseable) {\n        return false;\n      }\n\n      var isdatevalid = this.isDateValid(parseable);\n\n      if (!isdatevalid) {\n        return false;\n      }\n\n      return true;\n    }\n  }, {\n    key: 'handleClickOutside',\n    value: function handleClickOutside(evt) {\n      var _state = this.state,\n          value = _state.value,\n          pickerVisible = _state.pickerVisible;\n\n      if (!this.isInputFocus && !pickerVisible) {\n        return;\n      }\n\n      if (this.domRoot.contains(evt.target)) return;\n      if (this.pickerProxy && this.pickerProxy.contains(evt)) return;\n\n      if (this.isDateValid(value)) {\n        this.setState({\n          pickerVisible: false\n        });\n        this.props.onChange(value);\n        this.context.form && this.context.form.onFieldChange();\n      } else {\n        this.setState({\n          pickerVisible: false,\n          text: this.dateToStr(value)\n        });\n      }\n    }\n  }, {\n    key: 'handleClickIcon',\n    value: function handleClickIcon() {\n      var _props = this.props,\n          isReadOnly = _props.isReadOnly,\n          isDisabled = _props.isDisabled;\n      var text = this.state.text;\n      if (isReadOnly || isDisabled) return;\n\n      if (!text) {\n        this.togglePickerVisible();\n      } else {\n        this.setState({\n          text: '',\n          value: null,\n          pickerVisible: false\n        });\n        this.props.onChange(null);\n        this.context.form && this.context.form.onFieldChange();\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this3 = this;\n\n      var _props2 = this.props,\n          isReadOnly = _props2.isReadOnly,\n          placeholder = _props2.placeholder,\n          isDisabled = _props2.isDisabled,\n          className = _props2.className;\n      var _state2 = this.state,\n          pickerVisible = _state2.pickerVisible,\n          value = _state2.value,\n          text = _state2.text,\n          isShowClose = _state2.isShowClose;\n\n      var createIconSlot = function createIconSlot() {\n        if (_this3.calcIsShowTrigger()) {\n          var cls = isShowClose ? 'el-icon-close' : _this3.triggerClass();\n          return _react2.default.createElement('i', {\n            className: _this3.classNames('el-input__icon', cls),\n            onClick: _this3.handleClickIcon.bind(_this3),\n            onMouseEnter: function onMouseEnter() {\n              if (isReadOnly || isDisabled) return;\n\n              if (text) {\n                _this3.setState({\n                  isShowClose: true\n                });\n              }\n            },\n            onMouseLeave: function onMouseLeave() {\n              _this3.setState({\n                isShowClose: false\n              });\n            }\n          });\n        } else {\n          return null;\n        }\n      };\n\n      var createPickerPanel = function createPickerPanel() {\n        if (pickerVisible) {\n          /* eslint-disable */\n          var _props3 = _this3.props,\n              _placeholder = _props3.placeholder,\n              onFocus = _props3.onFocus,\n              onBlur = _props3.onBlur,\n              onChange = _props3.onChange,\n              others = (0, _objectWithoutProperties3.default)(_props3, ['placeholder', 'onFocus', 'onBlur', 'onChange']);\n          /* eslint-enable */\n\n          return _react2.default.createElement(_MountBody.MountBody, {\n            ref: function ref(e) {\n              return _this3.pickerProxy = e;\n            }\n          }, _this3.pickerPanel(_this3.state, (0, _extends3.default)({}, others, {\n            getPopperRefElement: function getPopperRefElement() {\n              return _reactDom2.default.findDOMNode(_this3.refs.inputRoot);\n            },\n            popperMixinOption: {\n              placement: _constants.PLACEMENT_MAP[_this3.props.align] || _constants.PLACEMENT_MAP.left\n            }\n          })));\n        } else {\n          return null;\n        }\n      };\n\n      return _react2.default.createElement('span', {\n        className: this.classNames('el-date-editor', className, {\n          'is-have-trigger': this.calcIsShowTrigger(),\n          'is-active': pickerVisible,\n          'is-filled': !!value\n        }),\n        ref: function ref(v) {\n          return _this3.domRoot = v;\n        }\n      }, _react2.default.createElement(_internal.EventRegister, {\n        id: this.clickOutsideId,\n        target: document,\n        eventName: 'click',\n        func: this.handleClickOutside.bind(this)\n      }), _react2.default.createElement(_input2.default, {\n        className: this.classNames('el-date-editor el-date-editor--' + this.type),\n        readOnly: isReadOnly,\n        disabled: isDisabled,\n        type: 'text',\n        placeholder: placeholder,\n        onFocus: this.handleFocus.bind(this),\n        onBlur: this.handleBlur.bind(this),\n        onKeyDown: this.handleKeydown.bind(this),\n        onChange: function onChange(value) {\n          var iptxt = value;\n          var nstate = {\n            text: iptxt\n          };\n\n          if (iptxt.trim() === '' || !_this3.isInputValid(iptxt)) {\n            nstate.value = null;\n          } else {\n            //only set value on a valid date input\n            nstate.value = _this3.parseDate(iptxt);\n          }\n\n          _this3.setState(nstate);\n        },\n        ref: 'inputRoot',\n        value: text,\n        icon: createIconSlot()\n      }), createPickerPanel());\n    }\n  }, {\n    key: '__reactstandin__regenerateByEval',\n    // @ts-ignore\n    value: function __reactstandin__regenerateByEval(key, code) {\n      // @ts-ignore\n      this[key] = eval(code);\n    }\n  }]);\n  return BasePicker;\n}(_libs.Component);\n\nvar _default = BasePicker;\nexports.default = _default;\nBasePicker.contextTypes = {\n  form: _libs.PropTypes.any\n};\n;\n\n(function () {\n  var reactHotLoader = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).default;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(idGen, 'idGen', 'src/date-picker/BasePicker.jsx');\n  reactHotLoader.register(haveTriggerType, 'haveTriggerType', 'src/date-picker/BasePicker.jsx');\n  reactHotLoader.register(isValidValue, 'isValidValue', 'src/date-picker/BasePicker.jsx');\n  reactHotLoader.register(valueEquals, 'valueEquals', 'src/date-picker/BasePicker.jsx');\n  reactHotLoader.register(BasePicker, 'BasePicker', 'src/date-picker/BasePicker.jsx');\n  reactHotLoader.register(_default, 'default', 'src/date-picker/BasePicker.jsx');\n})();\n\n;\n\n(function () {\n  var leaveModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).leaveModule;\n  leaveModule && leaveModule(module);\n})();","map":{"version":3,"sources":["/home/flo/Projects/react/Holirate/node_modules/element-react/dist/npm/es5/src/date-picker/BasePicker.js"],"names":["Object","defineProperty","exports","value","_extends2","require","_extends3","_interopRequireDefault","_objectWithoutProperties2","_objectWithoutProperties3","_classCallCheck2","_classCallCheck3","_possibleConstructorReturn2","_possibleConstructorReturn3","_createClass2","_createClass3","_inherits2","_inherits3","_react","_react2","_reactDom","_reactDom2","_libs","_internal","_input","_input2","_constants","_utils","_MountBody","obj","__esModule","default","enterModule","reactHotLoaderGlobal","module","idGen","IDGenerator","haveTriggerType","type","HAVE_TRIGGER_TYPES","indexOf","isValidValue","Date","Array","isArray","length","valueEquals","a","b","aIsArray","bIsArray","isEqual","equal","getTime","BasePicker","_Component","key","get","align","PropTypes","oneOf","className","string","format","isShowTrigger","bool","isReadOnly","isDisabled","placeholder","onFocus","func","onBlur","onChange","oneOfType","instanceOf","arrayOf","props","_type","state","arguments","undefined","require_condition","_this","__proto__","getPrototypeOf","call","assign","pickerVisible","propsToState","clickOutsideId","next","pickerPanel","Errors","MethodImplementationRequiredError","getFormatSeparator","componentWillReceiveProps","nextProps","setState","onPicked","isKeepPannel","hasChanged","text","dateToStr","context","form","onFieldChange","date","tdate","formatter","TYPE_VALUE_RESOLVER_MAP","result","getFormat","parseDate","dateStr","parser","DEFAULT_FORMATS","isDateValid","triggerClass","includes","calcIsShowTrigger","handleFocus","_this2","isInputFocus","handleBlur","handleKeydown","evt","keyCode","stopPropagation","togglePickerVisible","isInputValid","parseable","isdatevalid","handleClickOutside","_state","domRoot","contains","target","pickerProxy","handleClickIcon","_props","render","_this3","_props2","_state2","isShowClose","createIconSlot","cls","createElement","classNames","onClick","bind","onMouseEnter","onMouseLeave","createPickerPanel","_props3","_placeholder","others","MountBody","ref","e","getPopperRefElement","findDOMNode","refs","inputRoot","popperMixinOption","placement","PLACEMENT_MAP","left","v","EventRegister","id","document","eventName","readOnly","disabled","onKeyDown","iptxt","nstate","trim","icon","__reactstandin__regenerateByEval","code","eval","Component","_default","contextTypes","any","reactHotLoader","register","leaveModule"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _objectWithoutProperties2 = require('babel-runtime/helpers/objectWithoutProperties');\n\nvar _objectWithoutProperties3 = _interopRequireDefault(_objectWithoutProperties2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require('react-dom');\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _libs = require('../../libs');\n\nvar _internal = require('../../libs/internal');\n\nvar _input = require('../input');\n\nvar _input2 = _interopRequireDefault(_input);\n\nvar _constants = require('./constants');\n\nvar _utils = require('../../libs/utils');\n\nvar _MountBody = require('./MountBody');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n(function () {\n  var enterModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).enterModule;\n  enterModule && enterModule(module);\n})();\n\nvar idGen = new _utils.IDGenerator();\nvar haveTriggerType = function haveTriggerType(type) {\n  return _constants.HAVE_TRIGGER_TYPES.indexOf(type) !== -1;\n};\n\nvar isValidValue = function isValidValue(value) {\n  if (value instanceof Date) return true;\n  if (Array.isArray(value) && value.length !== 0 && value[0] instanceof Date) return true;\n  return false;\n};\n\n// only considers date-picker's value: Date or [Date, Date]\nvar valueEquals = function valueEquals(a, b) {\n  var aIsArray = Array.isArray(a);\n  var bIsArray = Array.isArray(b);\n\n  var isEqual = function isEqual(a, b) {\n    // equal if a, b date is equal or both is null or undefined\n    var equal = false;\n    if (a && b) equal = a.getTime() === b.getTime();else equal = a === b && a == null;\n    return equal;\n  };\n\n  if (aIsArray && bIsArray) {\n    return isEqual(a[0], b[0]) && isEqual(a[1], b[1]);\n  }\n  if (!aIsArray && !bIsArray) {\n    return isEqual(a, b);\n  }\n  return false;\n};\n\nvar BasePicker = function (_Component) {\n  (0, _inherits3.default)(BasePicker, _Component);\n  (0, _createClass3.default)(BasePicker, null, [{\n    key: 'propTypes',\n    get: function get() {\n      return {\n        align: _libs.PropTypes.oneOf(['left', 'center', 'right']),\n        className: _libs.PropTypes.string,\n        format: _libs.PropTypes.string,\n        isShowTrigger: _libs.PropTypes.bool,\n        isReadOnly: _libs.PropTypes.bool,\n        isDisabled: _libs.PropTypes.bool,\n        placeholder: _libs.PropTypes.string,\n        onFocus: _libs.PropTypes.func,\n        onBlur: _libs.PropTypes.func,\n        // (Date|Date[]|null)=>(), null when click on clear icon\n        onChange: _libs.PropTypes.func,\n        // time select pannel:\n        value: _libs.PropTypes.oneOfType([_libs.PropTypes.instanceOf(Date), _libs.PropTypes.arrayOf(_libs.PropTypes.instanceOf(Date))])\n      };\n    }\n  }, {\n    key: 'defaultProps',\n    get: function get() {\n      return {\n        value: new Date(),\n        // (thisReactElement)=>Unit\n        onFocus: function onFocus() {},\n        onBlur: function onBlur() {}\n      };\n    }\n  }]);\n\n  function BasePicker(props, _type) {\n    var state = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    (0, _classCallCheck3.default)(this, BasePicker);\n\n    (0, _utils.require_condition)(typeof _type === 'string');\n\n    var _this = (0, _possibleConstructorReturn3.default)(this, (BasePicker.__proto__ || Object.getPrototypeOf(BasePicker)).call(this, props));\n\n    _this.type = _type; // type need to be set first\n    _this.state = Object.assign({}, state, {\n      pickerVisible: false\n    }, _this.propsToState(props));\n\n    _this.clickOutsideId = 'clickOutsideId_' + idGen.next();\n    return _this;\n  }\n\n  // ---: start, abstract methods\n  // (state, props)=>ReactElement\n\n\n  (0, _createClass3.default)(BasePicker, [{\n    key: 'pickerPanel',\n    value: function pickerPanel(state, props) {\n      throw new _utils.Errors.MethodImplementationRequiredError(props);\n    }\n  }, {\n    key: 'getFormatSeparator',\n    value: function getFormatSeparator() {\n      return undefined;\n    }\n    // ---: end, abstract methods\n\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      this.setState(this.propsToState(nextProps));\n    }\n\n    /**\n     * onPicked should only be called from picker pannel instance\n     * and should never return a null date instance\n     *\n     * @param value: Date|Date[]|null\n     * @param isKeepPannel: boolean = false\n     */\n\n  }, {\n    key: 'onPicked',\n    value: function onPicked(value) {\n      var isKeepPannel = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      //only change input value on picked triggered\n      var hasChanged = !valueEquals(this.state.value, value);\n      this.setState({\n        pickerVisible: isKeepPannel,\n        value: value,\n        text: this.dateToStr(value)\n      });\n\n      if (hasChanged) {\n        this.props.onChange(value);\n        this.context.form && this.context.form.onFieldChange();\n      }\n    }\n  }, {\n    key: 'dateToStr',\n    value: function dateToStr(date) {\n      if (!isValidValue(date)) return '';\n\n      var tdate = date;\n      var formatter = (_constants.TYPE_VALUE_RESOLVER_MAP[this.type] || _constants.TYPE_VALUE_RESOLVER_MAP['default']).formatter;\n      var result = formatter(tdate, this.getFormat(), this.getFormatSeparator());\n\n      return result;\n    }\n\n    // (string) => Date | null\n\n  }, {\n    key: 'parseDate',\n    value: function parseDate(dateStr) {\n      if (!dateStr) return null;\n      var type = this.type;\n      var parser = (_constants.TYPE_VALUE_RESOLVER_MAP[type] || _constants.TYPE_VALUE_RESOLVER_MAP['default']).parser;\n      return parser(dateStr, this.getFormat(), this.getFormatSeparator());\n    }\n  }, {\n    key: 'getFormat',\n    value: function getFormat() {\n      return this.props.format || _constants.DEFAULT_FORMATS[this.type];\n    }\n  }, {\n    key: 'propsToState',\n    value: function propsToState(props) {\n      var state = {};\n      if (this.isDateValid(props.value)) {\n        state.text = this.dateToStr(props.value);\n        state.value = props.value;\n      } else {\n        state.text = '';\n        state.value = null;\n      }\n\n      // if (state.value == null) {\n      //   state.value = new Date()\n      // }\n\n      return state;\n    }\n  }, {\n    key: 'triggerClass',\n    value: function triggerClass() {\n      return this.type.includes('time') ? 'el-icon-time' : 'el-icon-date';\n    }\n  }, {\n    key: 'calcIsShowTrigger',\n    value: function calcIsShowTrigger() {\n      if (this.props.isShowTrigger != null) {\n        return !!this.props.isShowTrigger;\n      } else {\n        return haveTriggerType(this.type);\n      }\n    }\n  }, {\n    key: 'handleFocus',\n    value: function handleFocus() {\n      var _this2 = this;\n\n      this.isInputFocus = true;\n      if (haveTriggerType(this.type) && !this.state.pickerVisible) {\n        this.setState({ pickerVisible: true }, function () {\n          _this2.props.onFocus(_this2);\n        });\n      }\n    }\n  }, {\n    key: 'handleBlur',\n    value: function handleBlur() {\n      this.isInputFocus = false;\n      this.props.onBlur(this);\n    }\n  }, {\n    key: 'handleKeydown',\n    value: function handleKeydown(evt) {\n      var keyCode = evt.keyCode;\n      // tab\n      if (keyCode === 9 || keyCode === 27) {\n        this.setState({ pickerVisible: false });\n        evt.stopPropagation();\n      }\n    }\n  }, {\n    key: 'togglePickerVisible',\n    value: function togglePickerVisible() {\n      this.setState({\n        pickerVisible: !this.state.pickerVisible\n      });\n    }\n  }, {\n    key: 'isDateValid',\n    value: function isDateValid(date) {\n      return date == null || isValidValue(date);\n    }\n\n    // return true on condition\n    //  * input is parsable to date\n    //  * also meet your other condition\n\n  }, {\n    key: 'isInputValid',\n    value: function isInputValid(value) {\n      var parseable = this.parseDate(value);\n      if (!parseable) {\n        return false;\n      }\n\n      var isdatevalid = this.isDateValid(parseable);\n      if (!isdatevalid) {\n        return false;\n      }\n      return true;\n    }\n  }, {\n    key: 'handleClickOutside',\n    value: function handleClickOutside(evt) {\n      var _state = this.state,\n          value = _state.value,\n          pickerVisible = _state.pickerVisible;\n\n      if (!this.isInputFocus && !pickerVisible) {\n        return;\n      }\n      if (this.domRoot.contains(evt.target)) return;\n      if (this.pickerProxy && this.pickerProxy.contains(evt)) return;\n      if (this.isDateValid(value)) {\n        this.setState({ pickerVisible: false });\n        this.props.onChange(value);\n        this.context.form && this.context.form.onFieldChange();\n      } else {\n        this.setState({ pickerVisible: false, text: this.dateToStr(value) });\n      }\n    }\n  }, {\n    key: 'handleClickIcon',\n    value: function handleClickIcon() {\n      var _props = this.props,\n          isReadOnly = _props.isReadOnly,\n          isDisabled = _props.isDisabled;\n      var text = this.state.text;\n\n\n      if (isReadOnly || isDisabled) return;\n      if (!text) {\n        this.togglePickerVisible();\n      } else {\n        this.setState({ text: '', value: null, pickerVisible: false });\n        this.props.onChange(null);\n        this.context.form && this.context.form.onFieldChange();\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this3 = this;\n\n      var _props2 = this.props,\n          isReadOnly = _props2.isReadOnly,\n          placeholder = _props2.placeholder,\n          isDisabled = _props2.isDisabled,\n          className = _props2.className;\n      var _state2 = this.state,\n          pickerVisible = _state2.pickerVisible,\n          value = _state2.value,\n          text = _state2.text,\n          isShowClose = _state2.isShowClose;\n\n\n      var createIconSlot = function createIconSlot() {\n        if (_this3.calcIsShowTrigger()) {\n          var cls = isShowClose ? 'el-icon-close' : _this3.triggerClass();\n          return _react2.default.createElement('i', {\n            className: _this3.classNames('el-input__icon', cls),\n            onClick: _this3.handleClickIcon.bind(_this3),\n            onMouseEnter: function onMouseEnter() {\n              if (isReadOnly || isDisabled) return;\n              if (text) {\n                _this3.setState({ isShowClose: true });\n              }\n            },\n            onMouseLeave: function onMouseLeave() {\n              _this3.setState({ isShowClose: false });\n            }\n          });\n        } else {\n          return null;\n        }\n      };\n\n      var createPickerPanel = function createPickerPanel() {\n        if (pickerVisible) {\n          /* eslint-disable */\n          var _props3 = _this3.props,\n              _placeholder = _props3.placeholder,\n              onFocus = _props3.onFocus,\n              onBlur = _props3.onBlur,\n              onChange = _props3.onChange,\n              others = (0, _objectWithoutProperties3.default)(_props3, ['placeholder', 'onFocus', 'onBlur', 'onChange']);\n          /* eslint-enable */\n\n          return _react2.default.createElement(\n            _MountBody.MountBody,\n            { ref: function ref(e) {\n                return _this3.pickerProxy = e;\n              } },\n            _this3.pickerPanel(_this3.state, (0, _extends3.default)({}, others, {\n              getPopperRefElement: function getPopperRefElement() {\n                return _reactDom2.default.findDOMNode(_this3.refs.inputRoot);\n              },\n              popperMixinOption: {\n                placement: _constants.PLACEMENT_MAP[_this3.props.align] || _constants.PLACEMENT_MAP.left\n              }\n            }))\n          );\n        } else {\n          return null;\n        }\n      };\n\n      return _react2.default.createElement(\n        'span',\n        {\n          className: this.classNames('el-date-editor', className, {\n            'is-have-trigger': this.calcIsShowTrigger(),\n            'is-active': pickerVisible,\n            'is-filled': !!value\n          }),\n\n          ref: function ref(v) {\n            return _this3.domRoot = v;\n          }\n        },\n        _react2.default.createElement(_internal.EventRegister, {\n          id: this.clickOutsideId,\n          target: document,\n          eventName: 'click',\n          func: this.handleClickOutside.bind(this) }),\n        _react2.default.createElement(_input2.default, {\n          className: this.classNames('el-date-editor el-date-editor--' + this.type),\n          readOnly: isReadOnly,\n          disabled: isDisabled,\n          type: 'text',\n          placeholder: placeholder,\n          onFocus: this.handleFocus.bind(this),\n          onBlur: this.handleBlur.bind(this),\n          onKeyDown: this.handleKeydown.bind(this),\n          onChange: function onChange(value) {\n            var iptxt = value;\n            var nstate = { text: iptxt };\n\n            if (iptxt.trim() === '' || !_this3.isInputValid(iptxt)) {\n              nstate.value = null;\n            } else {\n              //only set value on a valid date input\n              nstate.value = _this3.parseDate(iptxt);\n            }\n\n            _this3.setState(nstate);\n          },\n          ref: 'inputRoot',\n          value: text,\n          icon: createIconSlot()\n        }),\n        createPickerPanel()\n      );\n    }\n  }, {\n    key: '__reactstandin__regenerateByEval',\n    // @ts-ignore\n    value: function __reactstandin__regenerateByEval(key, code) {\n      // @ts-ignore\n      this[key] = eval(code);\n    }\n  }]);\n  return BasePicker;\n}(_libs.Component);\n\nvar _default = BasePicker;\nexports.default = _default;\n\n\nBasePicker.contextTypes = {\n  form: _libs.PropTypes.any\n};\n;\n\n(function () {\n  var reactHotLoader = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).default;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(idGen, 'idGen', 'src/date-picker/BasePicker.jsx');\n  reactHotLoader.register(haveTriggerType, 'haveTriggerType', 'src/date-picker/BasePicker.jsx');\n  reactHotLoader.register(isValidValue, 'isValidValue', 'src/date-picker/BasePicker.jsx');\n  reactHotLoader.register(valueEquals, 'valueEquals', 'src/date-picker/BasePicker.jsx');\n  reactHotLoader.register(BasePicker, 'BasePicker', 'src/date-picker/BasePicker.jsx');\n  reactHotLoader.register(_default, 'default', 'src/date-picker/BasePicker.jsx');\n})();\n\n;\n\n(function () {\n  var leaveModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).leaveModule;\n  leaveModule && leaveModule(module);\n})();"]},"metadata":{},"sourceType":"script"}