{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar React = _interopRequireWildcard(_react);\n\nvar _throttleDebounce = require('throttle-debounce');\n\nvar _libs = require('../../libs');\n\nvar _resizeEvent = require('../../libs/utils/resize-event');\n\nvar _Table = require('./Table');\n\nvar _Table2 = _interopRequireDefault(_Table);\n\nvar _utils = require('./utils');\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\n(function () {\n  var enterModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).enterModule;\n  enterModule && enterModule(module);\n})();\n\nvar TableLayout = function (_Component) {\n  (0, _inherits3.default)(TableLayout, _Component);\n\n  function TableLayout(props) {\n    (0, _classCallCheck3.default)(this, TableLayout);\n\n    var _this = (0, _possibleConstructorReturn3.default)(this, (TableLayout.__proto__ || Object.getPrototypeOf(TableLayout)).call(this, props));\n\n    _this.state = {\n      height: props.height || props.maxHeight || null,\n      // Table's height or maxHeight prop\n      gutterWidth: (0, _utils.getScrollBarWidth)(),\n      // scrollBar width\n      tableHeight: null,\n      // Table's real height\n      headerHeight: null,\n      // header's height of Table\n      bodyHeight: null,\n      // body's height of Table\n      footerHeight: null,\n      // footer's height of Table\n      fixedBodyHeight: null,\n      // fixed body's height of Table\n      viewportHeight: null,\n      // Table's real height without y scroll bar height\n      scrollX: null,\n      // has x scroll bar\n      scrollY: null // has y scroll bar\n\n    };\n    _this.resizeListener = (0, _throttleDebounce.throttle)(50, function () {\n      _this.scheduleLayout();\n    });\n    return _this;\n  }\n\n  (0, _createClass3.default)(TableLayout, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.el = this.table.el;\n      this.scheduleLayout();\n      (0, _resizeEvent.addResizeListener)(this.el, this.resizeListener);\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      var preHeight = this.props.height || this.props.maxHeight;\n      var nextHeight = nextProps.height || nextProps.maxHeight;\n\n      if (preHeight !== nextHeight) {\n        this.setState({\n          height: nextHeight\n        });\n      }\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(preProps) {\n      var _this2 = this;\n\n      if (this.isPropChanged('columns', preProps) || this.isPropChanged('style', preProps) || this.isPropChanged('className', preProps)) {\n        this.scheduleLayout();\n        return;\n      }\n\n      var shouldUpdateHeight = ['height', 'maxHeight', 'data', 'store.expandingRows', 'expandRowKeys', 'showSummary', 'summaryMethod', 'sumText'].some(function (key) {\n        return _this2.isPropChanged(key, preProps);\n      });\n\n      if (shouldUpdateHeight) {\n        this.updateHeight();\n        this.updateScrollY();\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      (0, _resizeEvent.removeResizeListener)(this.el, this.resizeListener);\n    }\n  }, {\n    key: 'isPropChanged',\n    value: function isPropChanged(key, preProps) {\n      var prop = (0, _utils.getValueByPath)(this.props, key);\n      var preProp = (0, _utils.getValueByPath)(preProps, key);\n      return prop !== preProp;\n    }\n  }, {\n    key: 'getChildContext',\n    value: function getChildContext() {\n      return {\n        layout: this\n      };\n    }\n  }, {\n    key: 'scheduleLayout',\n    value: function scheduleLayout() {\n      var _this3 = this;\n\n      this.setState(this.caculateWidth(), function () {\n        _this3.updateHeight();\n\n        _this3.updateScrollY();\n      });\n    } // horizontal direction layout\n\n  }, {\n    key: 'caculateWidth',\n    value: function caculateWidth() {\n      var _props = this.props,\n          _props$tableStoreStat = _props.tableStoreState,\n          columns = _props$tableStoreStat.columns,\n          fixedColumns = _props$tableStoreStat.fixedColumns,\n          rightFixedColumns = _props$tableStoreStat.rightFixedColumns,\n          fit = _props.fit;\n      var gutterWidth = this.state.gutterWidth;\n      var bodyMinWidth = columns.reduce(function (pre, col) {\n        return pre + (col.width || col.minWidth);\n      }, 0);\n      var bodyWidth = this.table.el.clientWidth;\n      var scrollX = void 0;\n      var fixedWidth = void 0;\n      var rightFixedWidth = void 0; // mutate props (TableStore's state[columns])\n\n      var flexColumns = columns.filter(function (column) {\n        return typeof column.width !== 'number';\n      });\n\n      if (flexColumns.length && fit) {\n        if (bodyMinWidth < bodyWidth - gutterWidth) {\n          // no scroll bar\n          scrollX = false;\n          var totalFlexWidth = bodyWidth - gutterWidth - bodyMinWidth;\n\n          if (flexColumns.length === 1) {\n            flexColumns[0].realWidth = flexColumns[0].minWidth + totalFlexWidth;\n          } else {\n            var allColumnsWidth = flexColumns.reduce(function (pre, col) {\n              return pre + col.minWidth;\n            }, 0);\n            var flexWidthPerPixel = totalFlexWidth / allColumnsWidth;\n            var widthWithoutFirst = 0;\n            flexColumns.forEach(function (column, index) {\n              if (index === 0) return;\n              var flexWidth = Math.floor(column.minWidth * flexWidthPerPixel);\n              widthWithoutFirst += flexWidth;\n              column.realWidth = column.minWidth + flexWidth;\n            });\n            flexColumns[0].realWidth = flexColumns[0].minWidth + totalFlexWidth - widthWithoutFirst;\n          }\n        } else {\n          // have horizontal scroll bar\n          scrollX = true;\n          flexColumns.forEach(function (column) {\n            column.realWidth = column.minWidth;\n          });\n        }\n\n        bodyWidth = Math.max(bodyMinWidth, bodyWidth);\n      } else {\n        scrollX = bodyMinWidth > bodyWidth;\n        bodyWidth = bodyMinWidth;\n      }\n\n      if (fixedColumns.length) {\n        fixedWidth = fixedColumns.reduce(function (pre, col) {\n          return pre + col.realWidth;\n        }, 0);\n      }\n\n      if (rightFixedColumns.length) {\n        rightFixedWidth = rightFixedColumns.reduce(function (pre, col) {\n          return pre + col.realWidth;\n        }, 0);\n      }\n\n      return {\n        scrollX: scrollX,\n        bodyWidth: bodyWidth,\n        fixedWidth: fixedWidth,\n        rightFixedWidth: rightFixedWidth\n      };\n    } // vertical direction layout\n\n  }, {\n    key: 'updateHeight',\n    value: function updateHeight() {\n      var _this4 = this;\n\n      this.setState(function (state) {\n        var data = _this4.props.data;\n        var scrollX = state.scrollX,\n            gutterWidth = state.gutterWidth;\n        var noData = !data || !data.length;\n        var _table = _this4.table,\n            headerWrapper = _table.headerWrapper,\n            footerWrapper = _table.footerWrapper;\n        var tableHeight = _this4.el.clientHeight;\n        var headerHeight = headerWrapper ? headerWrapper.offsetHeight : 0;\n        var footerHeight = footerWrapper ? footerWrapper.offsetHeight : 0;\n        var bodyHeight = tableHeight - headerHeight - footerHeight + (footerWrapper ? 1 : 0);\n        var fixedBodyHeight = bodyHeight - (scrollX ? gutterWidth : 0);\n        var viewportHeight = tableHeight - (scrollX && !noData ? gutterWidth : 0);\n        return {\n          tableHeight: tableHeight,\n          headerHeight: headerHeight,\n          bodyHeight: bodyHeight,\n          footerHeight: footerHeight,\n          fixedBodyHeight: fixedBodyHeight,\n          viewportHeight: viewportHeight // no useful\n\n        };\n      });\n    } // judge if has scroll-Y bar\n\n  }, {\n    key: 'updateScrollY',\n    value: function updateScrollY() {\n      var _this5 = this;\n\n      this.setState(function (state) {\n        var bodyWrapper = _this5.table.bodyWrapper;\n        var fixedBodyHeight = state.fixedBodyHeight;\n        var body = bodyWrapper.querySelector('.el-table__body');\n        var scrollY = body.offsetHeight > fixedBodyHeight;\n        return {\n          scrollY: scrollY\n        };\n      });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this6 = this;\n\n      return React.createElement(_Table2.default, (0, _extends3.default)({\n        ref: function ref(table) {\n          _this6.table = table;\n        }\n      }, this.props, {\n        layout: this.state\n      }));\n    }\n  }, {\n    key: '__reactstandin__regenerateByEval',\n    // @ts-ignore\n    value: function __reactstandin__regenerateByEval(key, code) {\n      // @ts-ignore\n      this[key] = eval(code);\n    }\n  }]);\n  return TableLayout;\n}(_libs.Component);\n\nTableLayout.childContextTypes = {\n  layout: _libs.PropTypes.any\n};\nvar _default = TableLayout;\nexports.default = _default;\n;\n\n(function () {\n  var reactHotLoader = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).default;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(TableLayout, 'TableLayout', 'src/table/TableLayout.jsx');\n  reactHotLoader.register(_default, 'default', 'src/table/TableLayout.jsx');\n})();\n\n;\n\n(function () {\n  var leaveModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).leaveModule;\n  leaveModule && leaveModule(module);\n})();","map":{"version":3,"sources":["/home/flo/Projects/react/Holirate/node_modules/element-react/dist/npm/es5/src/table/TableLayout.js"],"names":["Object","defineProperty","exports","value","_extends2","require","_extends3","_interopRequireDefault","_classCallCheck2","_classCallCheck3","_createClass2","_createClass3","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","_react","React","_interopRequireWildcard","_throttleDebounce","_libs","_resizeEvent","_Table","_Table2","_utils","obj","__esModule","newObj","key","prototype","hasOwnProperty","call","default","enterModule","reactHotLoaderGlobal","module","TableLayout","_Component","props","_this","__proto__","getPrototypeOf","state","height","maxHeight","gutterWidth","getScrollBarWidth","tableHeight","headerHeight","bodyHeight","footerHeight","fixedBodyHeight","viewportHeight","scrollX","scrollY","resizeListener","throttle","scheduleLayout","componentDidMount","el","table","addResizeListener","componentWillReceiveProps","nextProps","preHeight","nextHeight","setState","componentDidUpdate","preProps","_this2","isPropChanged","shouldUpdateHeight","some","updateHeight","updateScrollY","componentWillUnmount","removeResizeListener","prop","getValueByPath","preProp","getChildContext","layout","_this3","caculateWidth","_props","_props$tableStoreStat","tableStoreState","columns","fixedColumns","rightFixedColumns","fit","bodyMinWidth","reduce","pre","col","width","minWidth","bodyWidth","clientWidth","fixedWidth","rightFixedWidth","flexColumns","filter","column","length","totalFlexWidth","realWidth","allColumnsWidth","flexWidthPerPixel","widthWithoutFirst","forEach","index","flexWidth","Math","floor","max","_this4","data","noData","_table","headerWrapper","footerWrapper","clientHeight","offsetHeight","_this5","bodyWrapper","body","querySelector","render","_this6","createElement","ref","__reactstandin__regenerateByEval","code","eval","Component","childContextTypes","PropTypes","any","_default","reactHotLoader","register","leaveModule"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar React = _interopRequireWildcard(_react);\n\nvar _throttleDebounce = require('throttle-debounce');\n\nvar _libs = require('../../libs');\n\nvar _resizeEvent = require('../../libs/utils/resize-event');\n\nvar _Table = require('./Table');\n\nvar _Table2 = _interopRequireDefault(_Table);\n\nvar _utils = require('./utils');\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n(function () {\n  var enterModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).enterModule;\n  enterModule && enterModule(module);\n})();\n\nvar TableLayout = function (_Component) {\n  (0, _inherits3.default)(TableLayout, _Component);\n\n  function TableLayout(props) {\n    (0, _classCallCheck3.default)(this, TableLayout);\n\n    var _this = (0, _possibleConstructorReturn3.default)(this, (TableLayout.__proto__ || Object.getPrototypeOf(TableLayout)).call(this, props));\n\n    _this.state = {\n      height: props.height || props.maxHeight || null, // Table's height or maxHeight prop\n      gutterWidth: (0, _utils.getScrollBarWidth)(), // scrollBar width\n      tableHeight: null, // Table's real height\n      headerHeight: null, // header's height of Table\n      bodyHeight: null, // body's height of Table\n      footerHeight: null, // footer's height of Table\n      fixedBodyHeight: null, // fixed body's height of Table\n      viewportHeight: null, // Table's real height without y scroll bar height\n      scrollX: null, // has x scroll bar\n      scrollY: null // has y scroll bar\n    };\n\n    _this.resizeListener = (0, _throttleDebounce.throttle)(50, function () {\n      _this.scheduleLayout();\n    });\n    return _this;\n  }\n\n  (0, _createClass3.default)(TableLayout, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.el = this.table.el;\n\n      this.scheduleLayout();\n      (0, _resizeEvent.addResizeListener)(this.el, this.resizeListener);\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      var preHeight = this.props.height || this.props.maxHeight;\n      var nextHeight = nextProps.height || nextProps.maxHeight;\n      if (preHeight !== nextHeight) {\n        this.setState({\n          height: nextHeight\n        });\n      }\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(preProps) {\n      var _this2 = this;\n\n      if (this.isPropChanged('columns', preProps) || this.isPropChanged('style', preProps) || this.isPropChanged('className', preProps)) {\n        this.scheduleLayout();\n        return;\n      }\n\n      var shouldUpdateHeight = ['height', 'maxHeight', 'data', 'store.expandingRows', 'expandRowKeys', 'showSummary', 'summaryMethod', 'sumText'].some(function (key) {\n        return _this2.isPropChanged(key, preProps);\n      });\n      if (shouldUpdateHeight) {\n        this.updateHeight();\n        this.updateScrollY();\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      (0, _resizeEvent.removeResizeListener)(this.el, this.resizeListener);\n    }\n  }, {\n    key: 'isPropChanged',\n    value: function isPropChanged(key, preProps) {\n      var prop = (0, _utils.getValueByPath)(this.props, key);\n      var preProp = (0, _utils.getValueByPath)(preProps, key);\n      return prop !== preProp;\n    }\n  }, {\n    key: 'getChildContext',\n    value: function getChildContext() {\n      return {\n        layout: this\n      };\n    }\n  }, {\n    key: 'scheduleLayout',\n    value: function scheduleLayout() {\n      var _this3 = this;\n\n      this.setState(this.caculateWidth(), function () {\n        _this3.updateHeight();\n        _this3.updateScrollY();\n      });\n    }\n\n    // horizontal direction layout\n\n  }, {\n    key: 'caculateWidth',\n    value: function caculateWidth() {\n      var _props = this.props,\n          _props$tableStoreStat = _props.tableStoreState,\n          columns = _props$tableStoreStat.columns,\n          fixedColumns = _props$tableStoreStat.fixedColumns,\n          rightFixedColumns = _props$tableStoreStat.rightFixedColumns,\n          fit = _props.fit;\n      var gutterWidth = this.state.gutterWidth;\n\n      var bodyMinWidth = columns.reduce(function (pre, col) {\n        return pre + (col.width || col.minWidth);\n      }, 0);\n\n      var bodyWidth = this.table.el.clientWidth;\n      var scrollX = void 0;\n      var fixedWidth = void 0;\n      var rightFixedWidth = void 0;\n\n      // mutate props (TableStore's state[columns])\n      var flexColumns = columns.filter(function (column) {\n        return typeof column.width !== 'number';\n      });\n      if (flexColumns.length && fit) {\n        if (bodyMinWidth < bodyWidth - gutterWidth) {\n          // no scroll bar\n          scrollX = false;\n\n          var totalFlexWidth = bodyWidth - gutterWidth - bodyMinWidth;\n          if (flexColumns.length === 1) {\n            flexColumns[0].realWidth = flexColumns[0].minWidth + totalFlexWidth;\n          } else {\n            var allColumnsWidth = flexColumns.reduce(function (pre, col) {\n              return pre + col.minWidth;\n            }, 0);\n            var flexWidthPerPixel = totalFlexWidth / allColumnsWidth;\n\n            var widthWithoutFirst = 0;\n\n            flexColumns.forEach(function (column, index) {\n              if (index === 0) return;\n              var flexWidth = Math.floor(column.minWidth * flexWidthPerPixel);\n              widthWithoutFirst += flexWidth;\n              column.realWidth = column.minWidth + flexWidth;\n            });\n\n            flexColumns[0].realWidth = flexColumns[0].minWidth + totalFlexWidth - widthWithoutFirst;\n          }\n        } else {\n          // have horizontal scroll bar\n          scrollX = true;\n          flexColumns.forEach(function (column) {\n            column.realWidth = column.minWidth;\n          });\n        }\n\n        bodyWidth = Math.max(bodyMinWidth, bodyWidth);\n      } else {\n        scrollX = bodyMinWidth > bodyWidth;\n        bodyWidth = bodyMinWidth;\n      }\n\n      if (fixedColumns.length) {\n        fixedWidth = fixedColumns.reduce(function (pre, col) {\n          return pre + col.realWidth;\n        }, 0);\n      }\n\n      if (rightFixedColumns.length) {\n        rightFixedWidth = rightFixedColumns.reduce(function (pre, col) {\n          return pre + col.realWidth;\n        }, 0);\n      }\n\n      return {\n        scrollX: scrollX,\n        bodyWidth: bodyWidth,\n        fixedWidth: fixedWidth,\n        rightFixedWidth: rightFixedWidth\n      };\n    }\n\n    // vertical direction layout\n\n  }, {\n    key: 'updateHeight',\n    value: function updateHeight() {\n      var _this4 = this;\n\n      this.setState(function (state) {\n        var data = _this4.props.data;\n        var scrollX = state.scrollX,\n            gutterWidth = state.gutterWidth;\n\n\n        var noData = !data || !data.length;\n        var _table = _this4.table,\n            headerWrapper = _table.headerWrapper,\n            footerWrapper = _table.footerWrapper;\n\n\n        var tableHeight = _this4.el.clientHeight;\n        var headerHeight = headerWrapper ? headerWrapper.offsetHeight : 0;\n        var footerHeight = footerWrapper ? footerWrapper.offsetHeight : 0;\n        var bodyHeight = tableHeight - headerHeight - footerHeight + (footerWrapper ? 1 : 0);\n        var fixedBodyHeight = bodyHeight - (scrollX ? gutterWidth : 0);\n        var viewportHeight = tableHeight - (scrollX && !noData ? gutterWidth : 0);\n\n        return {\n          tableHeight: tableHeight,\n          headerHeight: headerHeight,\n          bodyHeight: bodyHeight,\n          footerHeight: footerHeight,\n          fixedBodyHeight: fixedBodyHeight,\n          viewportHeight: viewportHeight // no useful\n        };\n      });\n    }\n\n    // judge if has scroll-Y bar\n\n  }, {\n    key: 'updateScrollY',\n    value: function updateScrollY() {\n      var _this5 = this;\n\n      this.setState(function (state) {\n        var bodyWrapper = _this5.table.bodyWrapper;\n        var fixedBodyHeight = state.fixedBodyHeight;\n\n\n        var body = bodyWrapper.querySelector('.el-table__body');\n        var scrollY = body.offsetHeight > fixedBodyHeight;\n\n        return {\n          scrollY: scrollY\n        };\n      });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this6 = this;\n\n      return React.createElement(_Table2.default, (0, _extends3.default)({\n        ref: function ref(table) {\n          _this6.table = table;\n        }\n      }, this.props, {\n        layout: this.state\n      }));\n    }\n  }, {\n    key: '__reactstandin__regenerateByEval',\n    // @ts-ignore\n    value: function __reactstandin__regenerateByEval(key, code) {\n      // @ts-ignore\n      this[key] = eval(code);\n    }\n  }]);\n  return TableLayout;\n}(_libs.Component);\n\nTableLayout.childContextTypes = {\n  layout: _libs.PropTypes.any\n};\nvar _default = TableLayout;\nexports.default = _default;\n;\n\n(function () {\n  var reactHotLoader = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).default;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(TableLayout, 'TableLayout', 'src/table/TableLayout.jsx');\n  reactHotLoader.register(_default, 'default', 'src/table/TableLayout.jsx');\n})();\n\n;\n\n(function () {\n  var leaveModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).leaveModule;\n  leaveModule && leaveModule(module);\n})();"]},"metadata":{},"sourceType":"script"}