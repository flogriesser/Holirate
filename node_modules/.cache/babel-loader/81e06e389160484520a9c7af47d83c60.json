{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = upload;\n\n(function () {\n  var enterModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).enterModule;\n  enterModule && enterModule(module);\n})();\n\nfunction getError(action, option, xhr) {\n  var msg = void 0;\n\n  if (xhr.response) {\n    msg = xhr.status + ' ' + (xhr.response.error || xhr.response);\n  } else if (xhr.responseText) {\n    msg = xhr.status + ' ' + xhr.responseText;\n  } else {\n    msg = 'fail to post ' + action + ' ' + xhr.status;\n  }\n\n  var err = new Error(msg);\n  err.status = xhr.status;\n  err.method = 'post';\n  err.url = action;\n  return err;\n}\n\nfunction getBody(xhr) {\n  var text = xhr.responseText || xhr.response;\n\n  if (!text) {\n    return text;\n  }\n\n  try {\n    return JSON.parse(text);\n  } catch (e) {\n    return text;\n  }\n}\n\nfunction upload(option) {\n  if (typeof XMLHttpRequest === 'undefined') {\n    return;\n  }\n\n  var xhr = new XMLHttpRequest();\n  var action = option.action;\n\n  if (xhr.upload) {\n    xhr.upload.onprogress = function progress(e) {\n      if (e.total > 0) {\n        e.percent = e.loaded / e.total * 100;\n      }\n\n      option.onProgress(e);\n    };\n  }\n\n  var formData = new FormData();\n\n  if (option.data) {\n    Object.keys(option.data).map(function (key) {\n      formData.append(key, option.data[key]);\n    });\n  }\n\n  formData.append(option.filename, option.file);\n\n  xhr.onerror = function error(e) {\n    option.onError(e);\n  };\n\n  xhr.onload = function onload() {\n    if (xhr.status < 200 || xhr.status >= 300) {\n      return option.onError(getError(action, option, xhr));\n    }\n\n    option.onSuccess(getBody(xhr));\n  };\n\n  xhr.open('post', action, true);\n\n  if (option.withCredentials && 'withCredentials' in xhr) {\n    xhr.withCredentials = true;\n  }\n\n  var headers = option.headers || {};\n\n  for (var item in headers) {\n    if (headers.hasOwnProperty(item) && headers[item] !== null) {\n      xhr.setRequestHeader(item, headers[item]);\n    }\n  }\n\n  xhr.send(formData);\n  return xhr;\n}\n\n;\n\n(function () {\n  var reactHotLoader = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).default;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(getError, 'getError', 'src/upload/ajax.js');\n  reactHotLoader.register(getBody, 'getBody', 'src/upload/ajax.js');\n  reactHotLoader.register(upload, 'upload', 'src/upload/ajax.js');\n})();\n\n;\n\n(function () {\n  var leaveModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).leaveModule;\n  leaveModule && leaveModule(module);\n})();","map":{"version":3,"sources":["/home/flo/Projects/react/Holirate/node_modules/element-react/dist/npm/es5/src/upload/ajax.js"],"names":["Object","defineProperty","exports","value","default","upload","enterModule","reactHotLoaderGlobal","require","module","getError","action","option","xhr","msg","response","status","error","responseText","err","Error","method","url","getBody","text","JSON","parse","e","XMLHttpRequest","onprogress","progress","total","percent","loaded","onProgress","formData","FormData","data","keys","map","key","append","filename","file","onerror","onError","onload","onSuccess","open","withCredentials","headers","item","hasOwnProperty","setRequestHeader","send","reactHotLoader","register","leaveModule"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = upload;\n\n(function () {\n  var enterModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).enterModule;\n  enterModule && enterModule(module);\n})();\n\nfunction getError(action, option, xhr) {\n  var msg = void 0;\n  if (xhr.response) {\n    msg = xhr.status + ' ' + (xhr.response.error || xhr.response);\n  } else if (xhr.responseText) {\n    msg = xhr.status + ' ' + xhr.responseText;\n  } else {\n    msg = 'fail to post ' + action + ' ' + xhr.status;\n  }\n\n  var err = new Error(msg);\n  err.status = xhr.status;\n  err.method = 'post';\n  err.url = action;\n  return err;\n}\n\nfunction getBody(xhr) {\n  var text = xhr.responseText || xhr.response;\n  if (!text) {\n    return text;\n  }\n\n  try {\n    return JSON.parse(text);\n  } catch (e) {\n    return text;\n  }\n}\n\nfunction upload(option) {\n  if (typeof XMLHttpRequest === 'undefined') {\n    return;\n  }\n\n  var xhr = new XMLHttpRequest();\n  var action = option.action;\n\n  if (xhr.upload) {\n    xhr.upload.onprogress = function progress(e) {\n      if (e.total > 0) {\n        e.percent = e.loaded / e.total * 100;\n      }\n      option.onProgress(e);\n    };\n  }\n\n  var formData = new FormData();\n\n  if (option.data) {\n    Object.keys(option.data).map(function (key) {\n      formData.append(key, option.data[key]);\n    });\n  }\n\n  formData.append(option.filename, option.file);\n\n  xhr.onerror = function error(e) {\n    option.onError(e);\n  };\n\n  xhr.onload = function onload() {\n    if (xhr.status < 200 || xhr.status >= 300) {\n      return option.onError(getError(action, option, xhr));\n    }\n\n    option.onSuccess(getBody(xhr));\n  };\n\n  xhr.open('post', action, true);\n\n  if (option.withCredentials && 'withCredentials' in xhr) {\n    xhr.withCredentials = true;\n  }\n\n  var headers = option.headers || {};\n\n  for (var item in headers) {\n    if (headers.hasOwnProperty(item) && headers[item] !== null) {\n      xhr.setRequestHeader(item, headers[item]);\n    }\n  }\n  xhr.send(formData);\n  return xhr;\n}\n;\n\n(function () {\n  var reactHotLoader = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).default;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(getError, 'getError', 'src/upload/ajax.js');\n  reactHotLoader.register(getBody, 'getBody', 'src/upload/ajax.js');\n  reactHotLoader.register(upload, 'upload', 'src/upload/ajax.js');\n})();\n\n;\n\n(function () {\n  var leaveModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).leaveModule;\n  leaveModule && leaveModule(module);\n})();"]},"metadata":{},"sourceType":"script"}