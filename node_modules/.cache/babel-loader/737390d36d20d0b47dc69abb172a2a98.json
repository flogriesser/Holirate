{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _superagent = require('superagent');\n\nvar _superagent2 = _interopRequireDefault(_superagent);\n\nvar _bluebird = require('bluebird');\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _OrsUtil = require('./OrsUtil');\n\nvar _OrsUtil2 = _interopRequireDefault(_OrsUtil);\n\nvar _constants = require('./constants');\n\nvar _constants2 = _interopRequireDefault(_constants);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nvar orsUtil = new _OrsUtil2.default();\n\nvar OrsGeocode = function () {\n  function OrsGeocode(args) {\n    _classCallCheck(this, OrsGeocode);\n\n    this.args = {};\n\n    if (_constants2.default.apiKeyPropName in args) {\n      this.args.api_key = args.api_key;\n    } else {\n      // eslint-disable-next-line no-console\n      console.error(_constants2.default.missingAPIKeyMsg);\n    }\n\n    if (_constants2.default.propNames.host in args) {\n      this.args[_constants2.default.propNames.host] = args[_constants2.default.propNames.host];\n    }\n\n    if (_constants2.default.propNames.service in args) {\n      this.args[_constants2.default.propNames.service] = args[_constants2.default.propNames.service];\n    }\n\n    this.lookupParameter = {\n      api_key: function api_key(key, val) {\n        return key + '=' + val;\n      },\n      text: function text(key, val) {\n        return '&' + key + '=' + val;\n      },\n      focus_point: function focus_point(key, val) {\n        var urlParams = '';\n        urlParams += '&' + 'focus.point.lon' + '=' + val[1];\n        urlParams += '&' + 'focus.point.lat' + '=' + val[0];\n        return urlParams;\n      },\n      boundary_bbox: function boundary_bbox(key, val) {\n        var urlParams = '';\n        urlParams += '&' + 'boundary.rect.min_lon' + '=' + val[0][1];\n        urlParams += '&' + 'boundary.rect.min_lat' + '=' + val[0][0];\n        urlParams += '&' + 'boundary.rect.max_lon' + '=' + val[1][1];\n        urlParams += '&' + 'boundary.rect.max_lat' + '=' + val[1][0];\n        return urlParams;\n      },\n      point: function point(key, val) {\n        var urlParams = '';\n        urlParams += '&' + 'point.lon' + '=' + val.lat_lng[1];\n        urlParams += '&' + 'point.lat' + '=' + val.lat_lng[0];\n        urlParams += '&' + 'boundary.circle.radius' + '=' + val.radius;\n        return urlParams;\n      },\n      boundary_circle: function boundary_circle(key, val) {\n        var urlParams = '';\n        urlParams += '&' + 'boundary.circle.lon' + '=' + val.lat_lng[1];\n        urlParams += '&' + 'boundary.circle.lat' + '=' + val.lat_lng[0];\n        urlParams += '&' + 'boundary.circle.radius' + '=' + val.radius;\n        return urlParams;\n      },\n      sources: function sources(key, val) {\n        var urlParams = '&sources=';\n\n        for (var source in val) {\n          urlParams += source + ',';\n        }\n\n        return urlParams;\n      },\n      layers: function layers(key, val) {\n        var urlParams = '&layers=';\n        var counter = 0;\n\n        for (key in val) {\n          if (counter > 0) {\n            urlParams += ',';\n          }\n\n          urlParams += val[key];\n          counter++;\n        }\n\n        return urlParams;\n      },\n      boundary_country: function boundary_country(key, val) {\n        var urlParams = '&' + 'boundary.country' + '=' + val;\n        return urlParams;\n      },\n      size: function size(key, val) {\n        return '&' + key + '=' + val;\n      },\n      address: function address(key, val) {\n        return '&' + key + '=' + val;\n      },\n      neighbourhood: function neighbourhood(key, val) {\n        return '&' + key + '=' + val;\n      },\n      borough: function borough(key, val) {\n        return '&' + key + '=' + val;\n      },\n      locality: function locality(key, val) {\n        return '&' + key + '=' + val;\n      },\n      county: function county(key, val) {\n        return '&' + key + '=' + val;\n      },\n      region: function region(key, val) {\n        return '&' + key + '=' + val;\n      },\n      postalcode: function postalcode(key, val) {\n        return '&' + key + '=' + val;\n      },\n      country: function country(key, val) {\n        return '&' + key + '=' + val;\n      }\n    };\n  }\n\n  _createClass(OrsGeocode, [{\n    key: 'clear',\n    value: function clear() {\n      for (var variable in this.args) {\n        if (variable !== _constants2.default.apiKeyPropName) delete this.args[variable];\n      }\n    }\n  }, {\n    key: 'getParametersAsQueryString',\n    value: function getParametersAsQueryString(args) {\n      var queryString = '';\n\n      for (var key in args) {\n        var val = args[key];\n\n        if (_constants2.default.baseUrlConstituents.indexOf(key) > -1) {\n          continue;\n        } else queryString += this.lookupParameter[key](key, val);\n      }\n\n      return queryString;\n    }\n  }, {\n    key: 'geocodePromise',\n    value: function geocodePromise() {\n      var that = this;\n      return new _bluebird2.default(function (resolve, reject) {\n        var timeout = 5000; // Use old API via GET\n\n        var url = orsUtil.prepareUrl(that.args); // Add url query string from args\n\n        url += '?' + that.getParametersAsQueryString(that.args);\n\n        var orsRequest = _superagent2.default.get(url).timeout(timeout);\n\n        for (var key in that.customHeaders) {\n          orsRequest.set(key, that.customHeaders[key]);\n        }\n\n        orsRequest.end(function (err, res) {\n          if (err || !res.ok) {\n            // eslint-disable-next-line no-console\n            console.error(err);\n            reject(err);\n          } else if (res) {\n            resolve(res.body || res.text);\n          }\n        });\n      });\n    }\n  }, {\n    key: 'geocode',\n    value: function geocode(reqArgs) {\n      // Get custom header and remove from args\n      this.customHeaders = [];\n\n      if (reqArgs.customHeaders) {\n        this.customHeaders = reqArgs.customHeaders;\n        delete reqArgs.customHeaders;\n      }\n\n      orsUtil.setRequestDefaults(this.args, reqArgs); // eslint-disable-next-line prettier/prettier\n\n      if (!this.args[_constants2.default.propNames.service] && !reqArgs[_constants2.default.propNames.service]) {\n        reqArgs.service = 'geocode/search';\n      }\n\n      orsUtil.copyProperties(reqArgs, this.args);\n      return this.geocodePromise();\n    }\n  }, {\n    key: 'reverseGeocode',\n    value: function reverseGeocode(reqArgs) {\n      // Get custom header and remove from args\n      this.customHeaders = [];\n\n      if (reqArgs.customHeaders) {\n        this.customHeaders = reqArgs.customHeaders;\n        delete reqArgs.customHeaders;\n      }\n\n      orsUtil.setRequestDefaults(this.args, reqArgs); // eslint-disable-next-line prettier/prettier\n\n      if (!this.args[_constants2.default.propNames.service] && !reqArgs[_constants2.default.propNames.service]) {\n        reqArgs.service = 'geocode/reverse';\n      }\n\n      orsUtil.copyProperties(reqArgs, this.args);\n      return this.geocodePromise();\n    }\n  }, {\n    key: 'structuredGeocode',\n    value: function structuredGeocode(reqArgs) {\n      orsUtil.setRequestDefaults(this.args, reqArgs); // eslint-disable-next-line prettier/prettier\n\n      if (!this.args[_constants2.default.propNames.service] && !reqArgs[_constants2.default.propNames.service]) {\n        reqArgs.service = 'geocode/search/structured';\n      }\n\n      orsUtil.copyProperties(reqArgs, this.args);\n      return this.geocodePromise();\n    }\n  }]);\n\n  return OrsGeocode;\n}();\n\nexports.default = OrsGeocode;","map":{"version":3,"sources":["/home/flo/Projects/react/Holirate/node_modules/openrouteservice-js/npm_distribution/OrsGeocode.js"],"names":["Object","defineProperty","exports","value","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_superagent","require","_superagent2","_interopRequireDefault","_bluebird","_bluebird2","_OrsUtil","_OrsUtil2","_constants","_constants2","obj","__esModule","default","_classCallCheck","instance","TypeError","orsUtil","OrsGeocode","args","apiKeyPropName","api_key","console","error","missingAPIKeyMsg","propNames","host","service","lookupParameter","val","text","focus_point","urlParams","boundary_bbox","point","lat_lng","radius","boundary_circle","sources","source","layers","counter","boundary_country","size","address","neighbourhood","borough","locality","county","region","postalcode","country","clear","variable","getParametersAsQueryString","queryString","baseUrlConstituents","indexOf","geocodePromise","that","resolve","reject","timeout","url","prepareUrl","orsRequest","get","customHeaders","set","end","err","res","ok","body","geocode","reqArgs","setRequestDefaults","copyProperties","reverseGeocode","structuredGeocode"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _superagent = require('superagent');\n\nvar _superagent2 = _interopRequireDefault(_superagent);\n\nvar _bluebird = require('bluebird');\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _OrsUtil = require('./OrsUtil');\n\nvar _OrsUtil2 = _interopRequireDefault(_OrsUtil);\n\nvar _constants = require('./constants');\n\nvar _constants2 = _interopRequireDefault(_constants);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar orsUtil = new _OrsUtil2.default();\n\nvar OrsGeocode = function () {\n  function OrsGeocode(args) {\n    _classCallCheck(this, OrsGeocode);\n\n    this.args = {};\n    if (_constants2.default.apiKeyPropName in args) {\n      this.args.api_key = args.api_key;\n    } else {\n      // eslint-disable-next-line no-console\n      console.error(_constants2.default.missingAPIKeyMsg);\n    }\n    if (_constants2.default.propNames.host in args) {\n      this.args[_constants2.default.propNames.host] = args[_constants2.default.propNames.host];\n    }\n    if (_constants2.default.propNames.service in args) {\n      this.args[_constants2.default.propNames.service] = args[_constants2.default.propNames.service];\n    }\n\n    this.lookupParameter = {\n      api_key: function api_key(key, val) {\n        return key + '=' + val;\n      },\n      text: function text(key, val) {\n        return '&' + key + '=' + val;\n      },\n      focus_point: function focus_point(key, val) {\n        var urlParams = '';\n        urlParams += '&' + 'focus.point.lon' + '=' + val[1];\n        urlParams += '&' + 'focus.point.lat' + '=' + val[0];\n        return urlParams;\n      },\n      boundary_bbox: function boundary_bbox(key, val) {\n        var urlParams = '';\n        urlParams += '&' + 'boundary.rect.min_lon' + '=' + val[0][1];\n        urlParams += '&' + 'boundary.rect.min_lat' + '=' + val[0][0];\n        urlParams += '&' + 'boundary.rect.max_lon' + '=' + val[1][1];\n        urlParams += '&' + 'boundary.rect.max_lat' + '=' + val[1][0];\n\n        return urlParams;\n      },\n      point: function point(key, val) {\n        var urlParams = '';\n        urlParams += '&' + 'point.lon' + '=' + val.lat_lng[1];\n        urlParams += '&' + 'point.lat' + '=' + val.lat_lng[0];\n        urlParams += '&' + 'boundary.circle.radius' + '=' + val.radius;\n        return urlParams;\n      },\n      boundary_circle: function boundary_circle(key, val) {\n        var urlParams = '';\n        urlParams += '&' + 'boundary.circle.lon' + '=' + val.lat_lng[1];\n        urlParams += '&' + 'boundary.circle.lat' + '=' + val.lat_lng[0];\n        urlParams += '&' + 'boundary.circle.radius' + '=' + val.radius;\n\n        return urlParams;\n      },\n      sources: function sources(key, val) {\n        var urlParams = '&sources=';\n        for (var source in val) {\n          urlParams += source + ',';\n        }\n        return urlParams;\n      },\n      layers: function layers(key, val) {\n        var urlParams = '&layers=';\n        var counter = 0;\n        for (key in val) {\n          if (counter > 0) {\n            urlParams += ',';\n          }\n          urlParams += val[key];\n          counter++;\n        }\n        return urlParams;\n      },\n      boundary_country: function boundary_country(key, val) {\n        var urlParams = '&' + 'boundary.country' + '=' + val;\n        return urlParams;\n      },\n      size: function size(key, val) {\n        return '&' + key + '=' + val;\n      },\n      address: function address(key, val) {\n        return '&' + key + '=' + val;\n      },\n      neighbourhood: function neighbourhood(key, val) {\n        return '&' + key + '=' + val;\n      },\n      borough: function borough(key, val) {\n        return '&' + key + '=' + val;\n      },\n      locality: function locality(key, val) {\n        return '&' + key + '=' + val;\n      },\n      county: function county(key, val) {\n        return '&' + key + '=' + val;\n      },\n      region: function region(key, val) {\n        return '&' + key + '=' + val;\n      },\n      postalcode: function postalcode(key, val) {\n        return '&' + key + '=' + val;\n      },\n      country: function country(key, val) {\n        return '&' + key + '=' + val;\n      }\n    };\n  }\n\n  _createClass(OrsGeocode, [{\n    key: 'clear',\n    value: function clear() {\n      for (var variable in this.args) {\n        if (variable !== _constants2.default.apiKeyPropName) delete this.args[variable];\n      }\n    }\n  }, {\n    key: 'getParametersAsQueryString',\n    value: function getParametersAsQueryString(args) {\n      var queryString = '';\n      for (var key in args) {\n        var val = args[key];\n        if (_constants2.default.baseUrlConstituents.indexOf(key) > -1) {\n          continue;\n        } else queryString += this.lookupParameter[key](key, val);\n      }\n      return queryString;\n    }\n  }, {\n    key: 'geocodePromise',\n    value: function geocodePromise() {\n      var that = this;\n      return new _bluebird2.default(function (resolve, reject) {\n        var timeout = 5000;\n\n        // Use old API via GET\n        var url = orsUtil.prepareUrl(that.args);\n\n        // Add url query string from args\n        url += '?' + that.getParametersAsQueryString(that.args);\n\n        var orsRequest = _superagent2.default.get(url).timeout(timeout);\n\n        for (var key in that.customHeaders) {\n          orsRequest.set(key, that.customHeaders[key]);\n        }\n        orsRequest.end(function (err, res) {\n          if (err || !res.ok) {\n            // eslint-disable-next-line no-console\n            console.error(err);\n            reject(err);\n          } else if (res) {\n            resolve(res.body || res.text);\n          }\n        });\n      });\n    }\n  }, {\n    key: 'geocode',\n    value: function geocode(reqArgs) {\n      // Get custom header and remove from args\n      this.customHeaders = [];\n      if (reqArgs.customHeaders) {\n        this.customHeaders = reqArgs.customHeaders;\n        delete reqArgs.customHeaders;\n      }\n      orsUtil.setRequestDefaults(this.args, reqArgs);\n      // eslint-disable-next-line prettier/prettier\n      if (!this.args[_constants2.default.propNames.service] && !reqArgs[_constants2.default.propNames.service]) {\n        reqArgs.service = 'geocode/search';\n      }\n      orsUtil.copyProperties(reqArgs, this.args);\n      return this.geocodePromise();\n    }\n  }, {\n    key: 'reverseGeocode',\n    value: function reverseGeocode(reqArgs) {\n      // Get custom header and remove from args\n      this.customHeaders = [];\n      if (reqArgs.customHeaders) {\n        this.customHeaders = reqArgs.customHeaders;\n        delete reqArgs.customHeaders;\n      }\n      orsUtil.setRequestDefaults(this.args, reqArgs);\n      // eslint-disable-next-line prettier/prettier\n      if (!this.args[_constants2.default.propNames.service] && !reqArgs[_constants2.default.propNames.service]) {\n        reqArgs.service = 'geocode/reverse';\n      }\n      orsUtil.copyProperties(reqArgs, this.args);\n      return this.geocodePromise();\n    }\n  }, {\n    key: 'structuredGeocode',\n    value: function structuredGeocode(reqArgs) {\n      orsUtil.setRequestDefaults(this.args, reqArgs);\n      // eslint-disable-next-line prettier/prettier\n      if (!this.args[_constants2.default.propNames.service] && !reqArgs[_constants2.default.propNames.service]) {\n        reqArgs.service = 'geocode/search/structured';\n      }\n      orsUtil.copyProperties(reqArgs, this.args);\n      return this.geocodePromise();\n    }\n  }]);\n\n  return OrsGeocode;\n}();\n\nexports.default = OrsGeocode;"]},"metadata":{},"sourceType":"script"}