{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _superagent = require('superagent');\n\nvar _superagent2 = _interopRequireDefault(_superagent);\n\nvar _bluebird = require('bluebird');\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _OrsUtil = require('./OrsUtil');\n\nvar _OrsUtil2 = _interopRequireDefault(_OrsUtil);\n\nvar _constants = require('./constants');\n\nvar _constants2 = _interopRequireDefault(_constants);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nvar orsUtil = new _OrsUtil2.default();\n\nvar OrsDirections = function () {\n  function OrsDirections(args) {\n    _classCallCheck(this, OrsDirections);\n\n    this.requestSettings = null;\n    this.args = {};\n    this.meta = null;\n\n    if (_constants2.default.propNames.apiKey in args) {\n      this.args[_constants2.default.propNames.apiKey] = args[_constants2.default.propNames.apiKey];\n    } else {\n      // eslint-disable-next-line no-console\n      console.error(_constants2.default.missingAPIKeyMsg);\n    }\n\n    if (_constants2.default.propNames.host in args) {\n      this.args[_constants2.default.propNames.host] = args[_constants2.default.propNames.host];\n    }\n\n    if (_constants2.default.propNames.service in args) {\n      this.args[_constants2.default.propNames.service] = args[_constants2.default.propNames.service];\n    }\n  }\n\n  _createClass(OrsDirections, [{\n    key: 'clear',\n    value: function clear() {\n      for (var variable in this.args) {\n        if (variable !== _constants2.default.apiKeyPropName) delete this.args[variable];\n      }\n    }\n  }, {\n    key: 'clearPoints',\n    value: function clearPoints() {\n      if ('coordinates' in this.args) this.args.coordinates.length = 0;\n    }\n  }, {\n    key: 'addWaypoint',\n    value: function addWaypoint(latlon) {\n      if (!('coordinates' in this.args)) {\n        this.args.coordinates = [];\n      }\n\n      this.args.coordinates.push(latlon);\n    }\n  }, {\n    key: 'getBody',\n    value: function getBody(args) {\n      if (args.options && _typeof(args.options) !== 'object') {\n        args.options = JSON.parse(args.options);\n      } // Set the default vehicle type when profile is 'driving-hgv' if it is missing\n      // eslint-disable-next-line prettier/prettier\n\n\n      if (this.meta && this.meta.profile === 'driving-hgv' && (!args.options || !args.options.vehicle_type)) {\n        args.options.vehicle_type = 'hgv';\n      }\n\n      if (args.restrictions) {\n        args.options.profile_params = {\n          restrictions: _extends({}, args.restrictions)\n        };\n        delete args.options.restrictions;\n      }\n\n      if (args.avoidables) {\n        args.options.avoid_features = [].concat(_toConsumableArray(args.avoidables));\n        delete args.avoidables;\n      }\n\n      return args;\n    }\n  }, {\n    key: 'calculate',\n    value: function calculate(reqArgs) {\n      // Get custom header and remove from args\n      this.customHeaders = [];\n\n      if (reqArgs.customHeaders) {\n        this.customHeaders = reqArgs.customHeaders;\n        delete reqArgs.customHeaders;\n      }\n\n      orsUtil.setRequestDefaults(this.args, reqArgs, true);\n\n      if (!this.args[_constants2.default.propNames.service]) {\n        this.args[_constants2.default.propNames.service] = 'directions';\n      }\n\n      orsUtil.copyProperties(reqArgs, this.args);\n      var that = this;\n      return new _bluebird2.default(function (resolve, reject) {\n        var timeout = that.args[_constants2.default.propNames.timeout] || 10000; // meta should be generated once that subsequent requests work\n\n        if (that.meta == null) {\n          that.meta = orsUtil.prepareMeta(that.args);\n        }\n\n        that.httpArgs = orsUtil.prepareRequest(that.args);\n        var url = orsUtil.prepareUrl(that.meta);\n        var postBody = that.getBody(that.httpArgs);\n        var authorization = that.meta[_constants2.default.propNames.apiKey];\n\n        var orsRequest = _superagent2.default.post(url).send(postBody).set('Authorization', authorization).timeout(timeout); // .accept(that.meta.mimeType)\n\n\n        for (var key in that.customHeaders) {\n          orsRequest.set(key, that.customHeaders[key]);\n        }\n\n        orsRequest.end(function (err, res) {\n          if (err || !res.ok) {\n            // eslint-disable-next-line no-console\n            console.error(err);\n            reject(err);\n          } else if (res) {\n            resolve(res.body || res.text);\n          }\n        });\n      });\n    }\n  }]);\n\n  return OrsDirections;\n}();\n\nexports.default = OrsDirections;","map":{"version":3,"sources":["/home/flo/Projects/react/Holirate/node_modules/openrouteservice-js/npm_distribution/OrsDirections.js"],"names":["Object","defineProperty","exports","value","_extends","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_typeof","Symbol","iterator","obj","constructor","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","Constructor","protoProps","staticProps","_superagent","require","_superagent2","_interopRequireDefault","_bluebird","_bluebird2","_OrsUtil","_OrsUtil2","_constants","_constants2","__esModule","default","_toConsumableArray","arr","Array","isArray","arr2","from","_classCallCheck","instance","TypeError","orsUtil","OrsDirections","args","requestSettings","meta","propNames","apiKey","console","error","missingAPIKeyMsg","host","service","clear","variable","apiKeyPropName","clearPoints","coordinates","addWaypoint","latlon","push","getBody","options","JSON","parse","profile","vehicle_type","restrictions","profile_params","avoidables","avoid_features","concat","calculate","reqArgs","customHeaders","setRequestDefaults","copyProperties","that","resolve","reject","timeout","prepareMeta","httpArgs","prepareRequest","url","prepareUrl","postBody","authorization","orsRequest","post","send","set","end","err","res","ok","body","text"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _superagent = require('superagent');\n\nvar _superagent2 = _interopRequireDefault(_superagent);\n\nvar _bluebird = require('bluebird');\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _OrsUtil = require('./OrsUtil');\n\nvar _OrsUtil2 = _interopRequireDefault(_OrsUtil);\n\nvar _constants = require('./constants');\n\nvar _constants2 = _interopRequireDefault(_constants);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar orsUtil = new _OrsUtil2.default();\n\nvar OrsDirections = function () {\n  function OrsDirections(args) {\n    _classCallCheck(this, OrsDirections);\n\n    this.requestSettings = null;\n    this.args = {};\n    this.meta = null;\n    if (_constants2.default.propNames.apiKey in args) {\n      this.args[_constants2.default.propNames.apiKey] = args[_constants2.default.propNames.apiKey];\n    } else {\n      // eslint-disable-next-line no-console\n      console.error(_constants2.default.missingAPIKeyMsg);\n    }\n\n    if (_constants2.default.propNames.host in args) {\n      this.args[_constants2.default.propNames.host] = args[_constants2.default.propNames.host];\n    }\n    if (_constants2.default.propNames.service in args) {\n      this.args[_constants2.default.propNames.service] = args[_constants2.default.propNames.service];\n    }\n  }\n\n  _createClass(OrsDirections, [{\n    key: 'clear',\n    value: function clear() {\n      for (var variable in this.args) {\n        if (variable !== _constants2.default.apiKeyPropName) delete this.args[variable];\n      }\n    }\n  }, {\n    key: 'clearPoints',\n    value: function clearPoints() {\n      if ('coordinates' in this.args) this.args.coordinates.length = 0;\n    }\n  }, {\n    key: 'addWaypoint',\n    value: function addWaypoint(latlon) {\n      if (!('coordinates' in this.args)) {\n        this.args.coordinates = [];\n      }\n      this.args.coordinates.push(latlon);\n    }\n  }, {\n    key: 'getBody',\n    value: function getBody(args) {\n      if (args.options && _typeof(args.options) !== 'object') {\n        args.options = JSON.parse(args.options);\n      }\n\n      // Set the default vehicle type when profile is 'driving-hgv' if it is missing\n      // eslint-disable-next-line prettier/prettier\n      if (this.meta && this.meta.profile === 'driving-hgv' && (!args.options || !args.options.vehicle_type)) {\n        args.options.vehicle_type = 'hgv';\n      }\n\n      if (args.restrictions) {\n        args.options.profile_params = {\n          restrictions: _extends({}, args.restrictions)\n        };\n        delete args.options.restrictions;\n      }\n\n      if (args.avoidables) {\n        args.options.avoid_features = [].concat(_toConsumableArray(args.avoidables));\n        delete args.avoidables;\n      }\n      return args;\n    }\n  }, {\n    key: 'calculate',\n    value: function calculate(reqArgs) {\n      // Get custom header and remove from args\n      this.customHeaders = [];\n      if (reqArgs.customHeaders) {\n        this.customHeaders = reqArgs.customHeaders;\n        delete reqArgs.customHeaders;\n      }\n      orsUtil.setRequestDefaults(this.args, reqArgs, true);\n      if (!this.args[_constants2.default.propNames.service]) {\n        this.args[_constants2.default.propNames.service] = 'directions';\n      }\n      orsUtil.copyProperties(reqArgs, this.args);\n\n      var that = this;\n      return new _bluebird2.default(function (resolve, reject) {\n        var timeout = that.args[_constants2.default.propNames.timeout] || 10000;\n        // meta should be generated once that subsequent requests work\n        if (that.meta == null) {\n          that.meta = orsUtil.prepareMeta(that.args);\n        }\n        that.httpArgs = orsUtil.prepareRequest(that.args);\n        var url = orsUtil.prepareUrl(that.meta);\n\n        var postBody = that.getBody(that.httpArgs);\n        var authorization = that.meta[_constants2.default.propNames.apiKey];\n        var orsRequest = _superagent2.default.post(url).send(postBody).set('Authorization', authorization).timeout(timeout);\n        // .accept(that.meta.mimeType)\n\n        for (var key in that.customHeaders) {\n          orsRequest.set(key, that.customHeaders[key]);\n        }\n        orsRequest.end(function (err, res) {\n          if (err || !res.ok) {\n            // eslint-disable-next-line no-console\n            console.error(err);\n            reject(err);\n          } else if (res) {\n            resolve(res.body || res.text);\n          }\n        });\n      });\n    }\n  }]);\n\n  return OrsDirections;\n}();\n\nexports.default = OrsDirections;"]},"metadata":{},"sourceType":"script"}